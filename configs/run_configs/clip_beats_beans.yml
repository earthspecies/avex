---
# BEATs backbone trained with same hyper-parameters as clip_base_beans.yml
# Note: This is *not* a CLIP run (no text); it's plain supervised classification.

model_spec:
  name: beats
  pretrained: false
  device: cuda
  audio_config:
    sample_rate: 16000
    representation: raw
    normalize: false
    target_length_seconds: 10
    window_selection: random

dataset_config: configs/data_configs/data_base.yml

label_type: supervised
multilabel: false

preprocessing: null
sr: 16000
debug_mode: false

logging: mlflow
output_dir: "./runs/beats_beans_large_batch"

training_params:
  train_epochs: 70     # same as clip_base_beans
  lr: 0.0001
  batch_size: 512      # large batch from CLIP recipe
  optimizer: adamw8bit     # match opt
  weight_decay: 0.01
  amp: true
  amp_dtype: bf16
  log_steps: 100

scheduler:
  name: cosine
  warmup_steps: 500
  min_lr: 1e-6

augmentations:
  - noise:
      noise_dirs:
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/demand_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/idmt"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/tut2016_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/urbansound"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/freesound_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/orcasound_shipnoise_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/deepship_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/shipsear_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/wham_noise"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/audioset"
      snr_db_range: [-5, 20]
      augmentation_prob: 0.5
  - mixup:
      alpha: 0.4
      n_mixup: 1
      augmentation_prob: 0.5

loss_function: cross_entropy

device: cuda
seed: 43
num_workers: 8
run_name: beats_beans_large_batch
wandb_project: representation_learning
