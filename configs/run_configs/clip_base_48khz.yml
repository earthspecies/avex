---
# Model configuration
model_spec:
  name: clip
  # efficientnet_variant: b1
  pretrained: true
  audio_config:
    sample_rate: 48000
    n_fft: 2048
    hop_length: 512
    win_length: 2048
    window: hann
    n_mels: 128
    representation: mel_spectrogram
    normalize: false
    target_length_seconds: 10
    window_selection: random
  text_model_name: roberta-base
  projection_dim: 512
  temperature: 0.07

# Where to find the (now‑completed) dataset config created earlier
dataset_config: configs/data_configs/data_base.yml

# How to use the labels (supervised: use class indices, text: use text labels)
label_type: text

# audio preprocessing
preprocessing: null

# Target sample‑rate expected by the model
sr: 48000
debug_mode: false

# Log training runs to MLflow
logging: wandb
output_dir: "./runs/clip_baseline_48khz_10_06"

# Path to checkpoint to resume from (set to null or a path)
# resume_from_checkpoint: runs/clip_baseline_30_05/checkpoints/checkpoint_epoch_006.pt

training_params:
  train_epochs: 30
  lr: 0.0001
  batch_size: 400
  optimizer: adamw8bit
  weight_decay: 0.01
  amp: true
  amp_dtype: bf16
  log_steps: 100
  gradient_checkpointing: true

# Learning rate scheduler configuration
scheduler:
  name: cosine
  warmup_steps: 2000
  min_lr: 1e-6

augmentations:
  # Add background noise at random SNRs
  - noise:
      noise_dirs:
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/demand_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/idmt"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/tut2016_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/urbansound"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/freesound_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/\
          orcasound_shipnoise_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/deepship_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/shipsear_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/wham_noise"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
          foundation-model-storage/foundation-model-data/audio_16k/noise/audioset"
        # - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/\
        #   foundation-model-storage/foundation-model-data/audio_16k/noise/\
        #   ssw-detection"
      snr_db_range: [-5, 20]  # mix noise between -5 dB and 20 dB SNR
      augmentation_prob: 0.5
    # Mixup augmentation for audio samples
  # - mixup:
  #     alpha: 0.4  # Controls the Beta distribution shape
  #     n_mixup: 1  # Maximum number of mixup pairs per batch (defaults to 1)
  #     augmentation_prob: 0.5  # Probability of applying mixup to a batch

# Contrastive loss for CLIP training
loss_function: contrastive

device: cuda

seed: 13

num_workers: 8

run_name: clip_base

wandb_project: representation_learning
