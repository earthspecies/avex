---
# OpenBEATs Base (i2) fine-tuning on AnimalSpeak with wandb logging
model_spec:
  name: beats
  pretrained: true         # load HF OpenBEATs weights
  beats_variant: openbeats
  openbeats_size: base
  openbeats_repo_id: shikhar7ssu/OpenBEATs-Base-i2
  device: cuda
  audio_config:
    sample_rate: 16000
    representation: raw
    normalize: false
    target_length_seconds: 10
    window_selection: random

dataset_config: configs/data_configs/data_base.yml

output_dir: "./runs/animalspeak/openbeats_base_i2_ft"
run_name: openbeats_base_i2_animalspeak_ft
label_type: supervised

preprocessing: null
sr: 16000
debug_mode: false

logging: wandb
resume_from_checkpoint: null

training_params:
  train_epochs: 20
  lr: 0.0001
  batch_size: 64
  optimizer: adamw
  weight_decay: 0.01
  amp: true
  amp_dtype: bf16

scheduler:
  name: cosine
  warmup_steps: 500
  min_lr: 1e-6

loss_function: cross_entropy

seed: 42
num_workers: 10

wandb_project: representation_learning

augmentations:
  - noise:
      noise_dirs:
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/demand_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/idmt"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/tut2016_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/urbansound"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/freesound_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/orcasound_shipnoise_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/deepship_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/shipsear_10s"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/wham_noise"
        - "/home/milad_earthspecies_org/data-migration/lambda/home/ubuntu/foundation-model-storage/foundation-model-data/audio_16k/noise/audioset"
      snr_db_range: [-5, 20]
      augmentation_prob: 0.5
  - mixup:
      alpha: 0.4
      n_mixup: 1
      augmentation_prob: 0.5

