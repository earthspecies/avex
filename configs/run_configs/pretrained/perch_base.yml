---
# Perch model for bird audio classification
model_spec:
  name: perch
  pretrained: true  # Use Google's pretrained Perch weights
  model_size: base  # Options: "base", "large"
  embedding_dim: 1024  # Dimension of feature embeddings
  device: cuda
  audio_config:
    sample_rate: 32000  # Perch typically uses 32kHz
    representation: mel_spectrogram
    normalize: true
    target_length_seconds: 5
    window_selection: random
    n_mels: 128
    n_fft: 2048
    hop_length: 512

# Dataset configuration (path to a valid dataset config)
dataset_config: configs/data_configs/data_base.yml

# Output directory for checkpoints and logs
output_dir: "./perch_baseline"

label_type: supervised

# Audio preprocessing
preprocessing: null

# Target sample-rate expected by the model
sr: 32000
debug_mode: false

# Log training runs to MLflow
logging: mlflow

# Path to checkpoint to resume from (set to null or a path)
resume_from_checkpoint: null

training_params:
  train_epochs: 30
  lr: 0.0001
  batch_size: 128  # Smaller batch size for larger model
  optimizer: adamw
  weight_decay: 0.01
  amp: true
  amp_dtype: bf16

# Learning rate scheduler configuration
scheduler:
  name: cosine
  warmup_steps: 300
  min_lr: 1e-6

augmentations: []

# Loss for classification
loss_function: cross_entropy

# General settings
device: cuda
seed: 42
num_workers: 8

run_name: perch_base
wandb_project: representation_learning
