---
# BEATs/OpenBEATs backbone for evaluation (pretrained, frozen encoder)
# Uses HuggingFace pretrained checkpoints for linear probe evaluation

model_spec:
  name: openbeats                   # Uses unified BEATs implementation with openbeats variant
  pretrained: true
  model_id: "openbeats-large-i3"    # HuggingFace checkpoint to load (best performing)
  model_size: "large"               # base (~90M) or large (~317M)
  device: cuda
  audio_config:
    sample_rate: 16000
    representation: raw             # BEATs expects raw waveform
    normalize: false
    target_length_seconds: 10
    window_selection: random

# Dataset configuration (path to a valid dataset config)
dataset_config: configs/data_configs/data_base.yml

# Output directory for checkpoints and logs
output_dir: "./runs/openbeats_eval"
run_name: openbeats_eval
label_type: supervised

# Audio preprocessing (none â€“ handled inside the model)
preprocessing: null

# Target sample rate expected by the model
sr: 16000
debug_mode: false

# Log training runs to wandb
logging: wandb

# Path to checkpoint to resume from (set to null for pretrained)
resume_from_checkpoint: null

training_params:
  train_epochs: 20
  lr: 0.0001
  batch_size: 32
  optimizer: adamw
  weight_decay: 0.01
  amp: true
  amp_dtype: bf16

# Learning rate scheduler configuration
scheduler:
  name: cosine
  warmup_steps: 500
  min_lr: 1e-6

# Loss for classification
loss_function: cross_entropy

# General settings
seed: 42
num_workers: 8

wandb_project: representation_learning
